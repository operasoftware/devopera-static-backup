<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Creating an HTML5 canvas painting application - Dev.Opera</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="google-site-verification" content="L7q_7GF5c9d7ZAUYdfaTiRaB6sTAGv_cRz3nq5DsabM">
    <meta name="description" content="Dev.Opera is the ultimate source of distilled knowledge for web developers, covering the latest open web technologies and techniques including HTML5, CSS3, JavaScript, SVG, optimizing content for mobiles, tablets and TVs, and creating add-ons such as extensions and themes for the Opera browser.">
    <meta name="keywords" content="Opera, web, HTML5, HTML, CSS3, CSS, JavaScript, SVG, Geolocation, Widgets, Extensions, Unite, Mini, Mobile, web development, design, web design, tutorials, articles, examples, demos, web standards, open standards, open web, video, audio, getusermedia, accessibility, wai-aria, transitions, translations, microformats, microdata, dataset, media queries, viewport, @viewport, transparency, opacity, gradients, box-shadow, text-shadow, web fonts, appcache, websql, local storage, ajax, json, games, userjs, webgl, tv, tablet, emulator, skinning, themes, skins, drasgonfly, mathml, web sockets, operawatir">
    <link rel="icon" href="../../../../static.myopera.com/dev/img/speed_dial-icon.png" type="image/png">
    <link rel="apple-touch-icon" href="../../../../static.myopera.com/dev/img/touch-icon.png" type="image/png">
    <link rel="shortcut icon" href="../../../favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="../../../../static.myopera.com/dev/css/devopera.css" type="text/css">
    <!--[if IE 6]><link rel="stylesheet" href="/css/browsers/ie6.css" type="text/css"><![endif]-->
    <!--[if IE 7]><link rel="stylesheet" href="/css/browsers/ie7.css" type="text/css"><![endif]-->
    <!--[if IE 8]><link rel="stylesheet" href="/css/browsers/ie8.css" type="text/css"><![endif]-->
    <!--[if lte IE 8]><script type="text/javascript" src="/js/ie.js"></script><![endif]-->
    <link rel="stylesheet" href="../../../../static.myopera.com/dev/css/articles.css">
    <link rel="stylesheet" media="print" href="../../../../static.myopera.com/dev/css/print.css">
    <link rel="stylesheet" href="../../../../static.myopera.com/dev/css/github.css">
    <link rel="alternate" type="application/rss+xml" title="Recent articles - RSS 2.0 Feed" href="../../../feeds/rss/articles">
    <link rel="alternate" type="application/atom+xml" title="Recent articles - Atom 1.0 Feed" href="../../../feeds/atom/articles">
    <link rel="alternate" type="application/rss+xml" title="Recent articles in Web - RSS 2.0 Feed" href="../../../feeds/rss/articles/web">
    <link rel="alternate" type="application/atom+xml" title="Recent articles in Web - Atom 1.0 Feed" href="../../../feeds/atom/articles/web">
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="../../../../static.myopera.com/dev/js/menu.js"></script>
    <noscript>
      <style type="text/css">
.collection ul li ul {
    display: inherit !important;
}
      </style>
    </noscript>
    <script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-4118503-4']);
_gaq.push(['_gat._anonymizeIp']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
    </script>

  </head>
  <body class="web">
    <header role="banner"  class="article-view" >
      <div>
        <a href="../../../index.html" id="logo">Dev.Opera</a>
        <form action="http://dev.opera.com/search" role="search">
          <fieldset>
            <label class="hidden" for="q">Search</label>
            <input type="text" name="q" maxlength="256" value="" id="q" required>
            <input type="submit" id="q-submit" value="Search" title="Search">
          </fieldset>
        </form>
        <p id="login">
          <a href="../../../../../https/dev.opera.com/login/index.html" accesskey="L" title="Log in">Log in</a>
        </p>
        <nav id="nav">
          <ul role="menu">

            <li role="menuitem"  class="selected">
              <a href="../../../web.html">Web</a>
            </li>
            <li role="menuitem" >
              <a href="../../../addons.1.html">Add-ons</a>
            </li>
            <li role="menuitem" >
              <a href="../../../mobile.html">Mobile</a>
            </li>
            <li role="menuitem" >
              <a href="../../../tv.html">TV</a>
            </li>
            <li role="menuitem" >
              <a href="../../../labs.html">Labs</a>
            </li>
          </ul>
        </nav>
      </div>
    </header>
<section id="content" role="main" class="asideleft">
  <section class="main">
    <article lang="en">
      <h1>Creating an HTML5 canvas painting application</h1>
      <p class="print author">By Mihai Sucan</p>

         <h2>Table of contents</h2>

    <ul>
      <li><a href="index.html#introduction">Introduction</a></li>
      <li><a href="index.html#gettingstartedwiththehtml">Getting started with the 
        HTML</a></li>
      <li><a href="index.html#canvasinteraction">Canvas interaction</a>
        <ul>
          <li><a href="index.html#testingthecanvasinteraction">Testing the canvas 
            interaction</a></li>
          <li><a href="index.html#implementingevents">Implementing events</a></li>
          <li><a href="index.html#addingdrawingtools">Adding drawing tools</a>
            <ul>
              <li><a href="index.html#rectangle">Rectangle</a></li>
              <li><a href="index.html#line">Line</a></li>
            </ul>
          </li>
        </ul>
      </li>
      <li><a href="index.html#whatsnext">What&#39;s next</a></li>
    </ul>

    <h2 id="introduction">Introduction</h2>

    <p>My previous <a href="../html-5-canvas-the-basics/index.html">HTML5 canvas tutorial</a> provided you with insight into the numerous use cases 
    for canvas in web applications. In this article we will explore how you can 
    write your own canvas-based painting application.</p>

    <p>Making a web application that allows users to draw on a canvas requires  
    several important steps: setting up your <abbr title="HyperText Markup       Language">HTML</abbr> document with a canvas context (a 
    <code>canvas</code> element with an <code>id</code>), setting up your script 
    to target that canvas context and draw inside it and adding the required 
    mouse event handlers for user interaction and associated logic. Once the 
    event handlers are in place, it&#39;s then fairly simple to add any desired 
    functionality.</p>

    <p>The <a href="../../../../devfiles.myopera.com/articles/649/example5.html">final painting application example</a> looks like this:</p>

<img src="../../../../devfiles.myopera.com/articles/649/html5-canvas-painting-app.png" alt="The final painting application example from this article" />

    <p class="note">To make it easier to follow along with the code walkthrough 
    presented below, you can <a href="../../../../devfiles.myopera.com/articles/649/canvas-paint-tutorial.zip">download the full code 
      example</a> and follow along with it as you read the article.</p>

    <h2 id="gettingstartedwiththehtml">Getting started with the HTML</h2>

    <p>We shall begin with a minimal HTML document: </p>

<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&#34;en&#34;&gt;
  &lt;head&gt;
    &lt;meta charset=&#34;utf-8&#34;&gt;
    &lt;title&gt;Paint&lt;/title&gt;
    &lt;style type=&#34;text/css&#34;&gt;&lt;!--
      #container { position: relative; }
      #imageView { border: 1px solid #000; }
    --&gt;&lt;/style&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div id=&#34;container&#34;&gt;
      &lt;canvas id=&#34;imageView&#34; width=&#34;400&#34; height=&#34;300&#34;&gt;
        &lt;p&gt;Unfortunately, your browser is currently unsupported by our web 
        application.  We are sorry for the inconvenience. Please use one of the 
        supported browsers listed below, or draw the image you want using an 
        offline tool.&lt;/p&gt;
        &lt;p&gt;Supported browsers: &lt;a href=&#34;http://www.opera.com&#34;&gt;Opera&lt;/a&gt;, &lt;a 
          href=&#34;http://www.mozilla.com&#34;&gt;Firefox&lt;/a&gt;, &lt;a 
          href=&#34;http://www.apple.com/safari&#34;&gt;Safari&lt;/a&gt;, and &lt;a 
          href=&#34;http://www.konqueror.org&#34;&gt;Konqueror&lt;/a&gt;.&lt;/p&gt;
      &lt;/canvas&gt;
    &lt;/div&gt;

    &lt;script type=&#34;text/javascript&#34; 
    src=&#34;example1.js&#34;&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>

    <p>As you can see, we only have the bare bones of an HTML document here, 
    with a <code>canvas</code> element contained inside. If the browser does not 
    support Canvas, then the fallback content will show. We will add more markup 
    later on, but this is all we need for now.</p>

    <p>The fallback content you provide should be as helpful as possible. You 
    should not just say something like &quot;this web application is unsupported by 
    your browser&quot; - that would be basically useless. Tell the user what he/she 
    can do to get your application to work (eg use a different web browser), or 
    provide alternative solutions, like a file upload input which allows the 
    user to upload a painting created offline. Even better would be to detect Canvas support and then serve the application as is to browsers that support it, and the upload solution to browsers that don&#39;t, automatically. Naturally, the fallback content 
    depends on the context in which the painting application appears.</p>

    <h2 id="canvasinteraction">Canvas interaction</h2>

    <p>Now we have the <code>canvas</code> element in place, the next step is to 
    make the element somehow interact with the mouse. We shall first test our 
    interaction, and then go on to start adding in the functions we want our 
    application to perform.</p>

    <h3 id="testingthecanvasinteraction">Testing the canvas interaction</h3>

    <p>For testing purposes we shall first try to paint something under the 
    mouse. We can do that by attaching a <code>mousemove</code> event handler to 
    the <code>canvas</code> element. Here&#39;s the gist of the <a href="../../../../devfiles.myopera.com/articles/649/example1.js">mousemove example script</a>:</p>

<pre><code>// ...
function init () {
  // ...
  // Attach the mousemove event handler.
  canvas.addEventListener(&#39;mousemove&#39;, ev_mousemove, false);
}

// The mousemove event handler.
var started = false;
function ev_mousemove (ev) {
  var x, y;

  // Get the mouse position relative to the canvas element.
  if (ev.layerX || ev.layerX == 0) { // Firefox
    x = ev.layerX;
    y = ev.layerY;
  } else if (ev.offsetX || ev.offsetX == 0) { // Opera
    x = ev.offsetX;
    y = ev.offsetY;
  }

  // The event handler works like a drawing pencil which tracks the mouse 
  // movements. We start drawing a path made up of lines.
  if (!started) {
    context.beginPath();
    context.moveTo(x, y);
    started = true;
  } else {
    context.lineTo(x, y);
    context.stroke();
  }
}
// ...</code></pre>

    <p><a href="../../../../devfiles.myopera.com/articles/649/example1.html">Try the mousemove example live</a>.</p>

    <p>This code turned out to be a success: we are just starting to see how 
    dynamic and cool canvas can be. We use the <code>event.layer* 
      / offset*</code> properties to determine the mouse position relative to 
    the canvas element.  That&#39;s all we need to start drawing.</p>

    <h3 id="implementingevents">Implementing events</h3>
    <p>Let&#39;s take this script one step further. It&#39;s best to have a single event 
    handler that only determines the coordinates relative to the canvas element.  
    The implementation of each drawing tool should be split into independent 
    functions. Lastly, drawing tools need to interact with the user for events 
    like <code>mousedown</code> and <code>mouseup</code> as well, not just when 
    moving the mouse (<code>mousemove</code>). Therefore, multiple event 
    listeners will be added to the script.</p>

    <p>The <a href="../../../../devfiles.myopera.com/articles/649/example2.js">updated script including events</a> contains 
    the following snippet:</p>

<pre><code>// ...
function init () {
  // ...
  // The pencil tool instance.
  tool = new tool_pencil();

  // Attach the mousedown, mousemove and mouseup event listeners.
  canvas.addEventListener(&#39;mousedown&#39;, ev_canvas, false);
  canvas.addEventListener(&#39;mousemove&#39;, ev_canvas, false);
  canvas.addEventListener(&#39;mouseup&#39;,   ev_canvas, false);
}

// This painting tool works like a drawing pencil which tracks the mouse 
// movements.
function tool_pencil () {
  var tool = this;
  this.started = false;

  // This is called when you start holding down the mouse button.
  // This starts the pencil drawing.
  this.mousedown = function (ev) {
      context.beginPath();
      context.moveTo(ev._x, ev._y);
      tool.started = true;
  };

  // This function is called every time you move the mouse. Obviously, it only 
  // draws if the tool.started state is set to true (when you are holding down 
  // the mouse button).
  this.mousemove = function (ev) {
    if (tool.started) {
      context.lineTo(ev._x, ev._y);
      context.stroke();
    }
  };

  // This is called when you release the mouse button.
  this.mouseup = function (ev) {
    if (tool.started) {
      tool.mousemove(ev);
      tool.started = false;
    }
  };
}

// The general-purpose event handler. This function just determines the mouse 
// position relative to the canvas element.
function ev_canvas (ev) {
  if (ev.layerX || ev.layerX == 0) { // Firefox
    ev._x = ev.layerX;
    ev._y = ev.layerY;
  } else if (ev.offsetX || ev.offsetX == 0) { // Opera
    ev._x = ev.offsetX;
    ev._y = ev.offsetY;
  }

  // Call the event handler of the tool.
  var func = tool[ev.type];
  if (func) {
    func(ev);
  }
}
// ...</code></pre>

    <p><a href="../../../../devfiles.myopera.com/articles/649/example2.html">Try the updated freehand canvas example.</a></p>

    <p>The script has been split into multiple functions. Now the canvas has 
    three event listeners (<code>mousedown, mousemove</code> and 
    <code>mouseup</code>). The <code>ev_canvas()</code> function adds two new 
    properties to the <abbr title="Document Object Model">DOM</abbr> event 
    object, <var>_x</var> and <var>_y</var>, which simply hold the mouse 
    coordinates relative to the canvas. This event handler acts like a &quot;proxy&quot; 
    by calling other functions, depending on the event type. If the event is 
    <code>mousemove</code>, then <code>tool.mousemove()</code> is called, and so 
    on. The event handlers associated with the active tool can use the 
    properties added to the DOM event object.</p>

    <p>With the above changes made, we are ready to kick things off. The drawing 
    pencil works fine now, with the added start and end functions. All the 
    pencil-related functions are grouped together in a single function object.  
    Currently we only have the <var>tool_pencil</var> object present, instanced 
    as <var>tool</var>, but we can easily add more objects.</p>

    <h3 id="addingdrawingtools">Adding drawing tools</h3>

    <p>Let&#39;s add some more drawing tools, by adding more tool objects. Each new  
    tool needs to implement some of the available events.</p>

    <p>First, a drop-down menu will be added, to allow the user to select the 
    different drawing tools. This is achieved by adding the following into the 
    HTML document:</p>

<pre><code>&lt;body&gt;
&lt;p&gt;&lt;label&gt;Drawing tool: &lt;select id=&#34;dtool&#34;&gt;
  &lt;option value=&#34;rect&#34;&gt;Rectangle&lt;/option&gt;
  &lt;option value=&#34;pencil&#34;&gt;Pencil&lt;/option&gt;
&lt;/select&gt;&lt;/label&gt;&lt;/p&gt;
&lt;!-- ... --&gt;
&lt;/body&gt;</code></pre>

    <p>Then we update the script to handle more than just one tool:</p>

<pre><code>// ...
// The active tool instance.
var tool = false;
var tool_default = &#39;rect&#39;;

function init () {
  // ...
  // Get the tool select input.
  var tool_select = document.getElementById(&#39;dtool&#39;);
  if (!tool_select) {
    alert(&#39;Error: failed to get the dtool element!&#39;);
    return;
  }
  tool_select.addEventListener(&#39;change&#39;, ev_tool_change, false);

  // Activate the default tool.
  if (tools[tool_default]) {
    tool = new tools[tool_default]();
    tool_select.value = tool_default;
  }
  // ...
}

// ...
// The event handler for any changes made to the tool selector.
function ev_tool_change (ev) {
  if (tools[this.value]) {
    tool = new tools[this.value]();
  }
}

// This object holds the implementation of each drawing tool.
var tools = {};

// The drawing pencil.
tools.pencil = function () {
  // ...
};

// ...</code></pre>

    <p>That should be enough. The code above just sets up an event handler for 
    the <code>&lt;select&gt;</code> element. The implementation of each drawing 
    tool is now inside a single <var>tools</var> object, and the <var>tool</var> 
    variable just holds an instance of the active tool. The 
    <code>ev_tool_change()</code> function makes sure that the <var>tool</var> 
    variable is always an object instance of the tool picked by the user.</p>

    <p>The benefit of the above code is that any tool can have its own instance 
    logic, dependent on any factors you see fit. You can do anything you want 
    when the tool is activated, for example ask the user for a string, number or 
    some other input.</p>

    <p>Now we&#39;ve set up a solid groundwork for the tools and looked at the 
    pencil implementation, let&#39;s now look at implementing some of the other 
    individual tools.</p>

    <h4 id="rectangle">Rectangle</h4>
    <p>You are now in for a surprise. Let&#39;s implement the rectangle tool and 
    then <a href="../../../../devfiles.myopera.com/articles/649/example3.html">test the code</a>. Here&#39;s the <a href="../../../../devfiles.myopera.com/articles/649/example3.js">updated script</a>:</p>

<pre><code>// ...
tools.rect = function () {
  var tool = this;
  this.started = false;

  this.mousedown = function (ev) {
    tool.started = true;
    tool.x0 = ev._x;
    tool.y0 = ev._y;
  };

  this.mousemove = function (ev) {
    if (!tool.started) {
      return;
    }

    var x = Math.min(ev._x,  tool.x0),
        y = Math.min(ev._y,  tool.y0),
        w = Math.abs(ev._x - tool.x0),
        h = Math.abs(ev._y - tool.y0);

    context.clearRect(0, 0, canvas.width, canvas.height);

    if (!w || !h) {
      return;
    }

    context.strokeRect(x, y, w, h);
  };

  this.mouseup = function (ev) {
    if (tool.started) {
      tool.mousemove(ev);
      tool.started = false;
    }
  };
};
// ...</code></pre>

    <p>The implementation of the new rectangle tool should be straight-forward 
    and thus easy to understand. It maintains the same basic structure as the 
    pencil tool. The difference is that for the rectangle we store the start 
    point, which is needed so we can then draw the rectangle for each mouse move 
    (live feedback).</p>

    <p>Now, for the surprise: <a href="../../../../devfiles.myopera.com/articles/649/example3.html">Access the above example 
      link</a> and try drawing two rectangles.  Notice any problem?  Yes, that&#39;s 
    right: the previous drawing is always lost because of the 
    <code>clearRect()</code> method call. We cannot remove this call, because 
    the tool becomes useless if we do so (every rectangle resize remains on 
    screen, before you even release the mouse button to make your 
    selection).</p>

    <p>The solution is to use a temporary canvas for live feedback operations.  
    The script initialization adds a new <code>canvas</code> element with the 
    same dimensions as the original one, positioned on top. All tools must draw 
    on the temporary canvas. When their drawing operation ends, the pixels they 
    generated are then moved onto the background canvas.</p>

    <p><a href="../../../../devfiles.myopera.com/articles/649/example4.html">Try the updated rectangle example</a> - the 
    rectangle tool now works fine.</p>

    <p>Here are the <a href="../../../../devfiles.myopera.com/articles/649/example4.js">script changes</a> required. The 
    initialization function now looks like so:</p>

<pre><code>// ...
var canvas, context, canvaso, contexto;

function init () {
  // Find the canvas element.
  canvaso = document.getElementById(&#39;imageView&#39;);
  if (!canvaso) {
    alert(&#39;Error: I cannot find the canvas element!&#39;);
    return;
  }

  if (!canvaso.getContext) {
    alert(&#39;Error: no canvas.getContext!&#39;);
    return;
  }

  // Get the 2D canvas context.
  contexto = canvaso.getContext(&#39;2d&#39;);
  if (!contexto) {
    alert(&#39;Error: failed to getContext!&#39;);
    return;
  }

  // Add the temporary canvas.
  var container = canvaso.parentNode;
  canvas = document.createElement(&#39;canvas&#39;);
  if (!canvas) {
    alert(&#39;Error: I cannot create a new canvas element!&#39;);
    return;
  }

  canvas.id     = &#39;imageTemp&#39;;
  canvas.width  = canvaso.width;
  canvas.height = canvaso.height;
  container.appendChild(canvas);

  context = canvas.getContext(&#39;2d&#39;);

  // ...
}</code></pre>

    <p>The new <code>img_update()</code> function is as follows:</p>

<pre><code>// This function draws the #imageTemp canvas on top of #imageView,
// after which #imageTemp is cleared. This function is called each time when the
// user completes a drawing operation.
function img_update () {
  contexto.drawImage(canvas, 0, 0);
  context.clearRect(0, 0, canvas.width, canvas.height);
}</code></pre>

    <p>When any drawing operation is complete, the <code>img_update()</code> 
    function must be invoked, so that the new pixels get stored in the image.  
    For example, here is the minor update for the pencil tool:</p>

<pre><code>// The drawing pencil.
tools.pencil = function () {
  // ...
  this.mouseup = function (ev) {
    if (tool.started) {
      tool.mousemove(ev);
      tool.started = false;
      img_update();
    }
  };
};</code></pre>

    <p>In the case of the rectangle and pencil tools, the drawing operation is 
    complete once the user releases the mouse button, so we simply add the call 
    to <code>img_update()</code> into the <code>mouseup</code> event handler.  
    However, note that this call is dependent on each drawing tool 
    implementation, in order to ensure the additional flexibility required by 
    other use cases.</p>

    <p>The last part needing a minor update is the HTML document&#39;s CSS:</p>

<pre><code>&lt;style type=&#34;text/css&#34;&gt;
  #container { position: relative; }
  #imageView { border: 1px solid #000; }
  #imageTemp { position: absolute; top: 1px; left: 1px; }
&lt;/style&gt;</code></pre>

    <p>The <abbr title="Cascading Style Sheet">CSS</abbr> above rules are needed 
    to properly position the temporary <code>&lt;canvas&gt;</code> element on 
    top of the original one.</p>

    <h4 id="line">Line</h4>

    <p>With everything in place, adding new tools becomes easier and easier.  
    The <a href="../../../../devfiles.myopera.com/articles/649/example5.js">JavaScript implementation including the line 
      tool</a> looks like this:</p>

<pre><code>tools.line = function () {
  var tool = this;
  this.started = false;

  this.mousedown = function (ev) {
    tool.started = true;
    tool.x0 = ev._x;
    tool.y0 = ev._y;
  };

  this.mousemove = function (ev) {
    if (!tool.started) {
      return;
    }

    context.clearRect(0, 0, canvas.width, canvas.height);

    context.beginPath();
    context.moveTo(tool.x0, tool.y0);
    context.lineTo(ev._x,   ev._y);
    context.stroke();
    context.closePath();
  };

  this.mouseup = function (ev) {
    if (tool.started) {
      tool.mousemove(ev);
      tool.started = false;
      img_update();
    }
  };
};</code></pre>

    <p>That&#39;s it! <a href="../../../../devfiles.myopera.com/articles/649/example5.html">Try the line-drawing example for 
      yourself</a>.</p>

    <p>The line tool is very similar to the rectangle tool. The 
    <code>mousedown()</code> function stores the starting point, which is then 
    used in <code>mousemove()</code> for drawing the actual line.</p>

    <h2 id="whatsnext">What&#39;s next?</h2>

    <p>The above should give you a fairly good understanding of what it takes to 
    <em>start</em> developing an online paint application. Besides just drawing 
    on the canvas you need to take into consideration other aspects as well, 
    such as:</p>

    <ul>
      <li>The current structure of the drawing tool objects is roughly 
      events-based. You will need events for pre-activation, post-activation and 
      deactivation for some of your tools. For example, an &quot;Insert image&quot; tool 
      might ask the user for the URL, but if the user decides to cancel, your 
      script must somehow cancel the activation of said tool.</li>

      <li>You will certainly need more event listeners, not just the three 
      listed in the previous point (think of context menus, double clicks and 
      more).  Adding any new event to the list is a trivial task.</li>

      <li>You need a way to store history steps for undoing / redoing 
      operations. There are three approaches for this: store the entire image in 
      memory for each step, remember each operation executed (like a macro), or 
      a hybrid between the two methods. Each method has its own pros and cons. The 
      first method is faster and easier to implement, but uses too much memory, 
      and with big images it is slow to store the image in the history. The 
      second method is more complex, but faster when considering just storing 
      the macro commands for each step; there is still a slowness associated 
      with actually executing undo / redo however - you have to re-execute the 
      commands in history. The hybrid method is the most complex approach, but 
      depending on your implementation it should be the fastest.</li>

      <li>Keyboard shortcuts for most drawing operations are needed. This means 
      that the drawing tool objects need more event handlers. I will deal with the keyboard accessibility of this application in a future article - watch this space.</li>

      <li>Each tool should have its own set of properties and options (colors, 
      line thickness, and more).</li>

      <li>You might want to consider combining <abbr title="Scalable Vector         Graphics">SVG</abbr> with canvas, for more possibilities.</li>

      <li>What makes or breaks an application is its user interface: commands, 
      tools, keyboard shortcuts, and the general use-cases best handled by the 
      application. You have to make your application pleasant for daily usage as 
      well as cool.</li>
    </ul>

    <p>If you want to learn more, you can take a look at the open-source project 
    <a href="http://code.google.com/p/paintweb/">Paint.Web</a>. This tutorial is 
    based on the code used for Paint.Web, thus you should already have 
    a head-start in understanding that code. At the moment, Paint.Web is in 
    a permanent state of evolution, and it has already tackled some of the 
    aspects mentioned above.</p>

  <h2 id="readmore">Read more...</h2>
  <ul>
    <li><a href="../html-5-canvas-the-basics/index.html">HTML5 canvas - the basics</a></li>
    <li><a href="../svg-or-canvas-choosing-between-the-two/index.html">SVG or Canvas? Ð¡hoosing between the two</a></li>
  </ul>

      <p id="license" class="info">This article is licensed under a <a href="http://creativecommons.org/licenses/by-nc-sa/2.5/" rel="license">Creative Commons Attribution, Non Commercial - Share Alike 2.5</a> license.</p>

    </article>
<section id="comments">
  <h2>Comments</h2>
      <p class="info">The forum archive of this article is still available on <a href="http://my.opera.com/community/forums/topic.dml?id=270054">My Opera</a>.</p>
  <ul>
    <li id="comment-84044482">
      <a href="../../../author/vanez88.html"><img src="../../../../../https/static.myopera.com/avatars/pool1/be/605/1a96addfe8112a2175f2f59a55691bb470f." alt="photo" class="avatar"/></a>
      <p class="commenter"><a href="../../../author/vanez88.html">vanez88</a></p>
      <p class="commentdate">Monday, March 5, 2012</p>
      <section class="commentcontent"><span class="bubble-arrow"></span>I&#39;m a little bit confuse on this script <br/>                                          var tools ={};<br/>			tools.asd = function()<br/>			{<br/>				this.start=2;	<br/>			}<br/>			var tool = new tools[&#39;asd&#39;]();<br/>			alert(tool.start);<br/>Can you tell what method is this ? </section>
    </li>
    <li id="comment-84053052">
      <a href="../../../author/chrismills.html"><img src="../../../../../https/static.myopera.com/avatars/pool1/49/546/4272683e28ab456dc962e131580e44990be.jpg" alt="photo" class="avatar"/></a>
      <p class="commenter"><a href="../../../author/chrismills.html">Chris Mills</a></p>
      <p class="commentdate">Monday, March 5, 2012</p>
      <section class="commentcontent"><span class="bubble-arrow"></span>@vanez88 We are making a new empty object called tools, then creating a method called asd that records a start property of two. We are then creating a new instance of the tools object called tool, and alerting the value of the inherited start property.<br/><br/>Hope this helps. I am probably misunderstanding the question ;-) </section>
    </li>
    <li id="comment-113335842">
      <a href="../../../author/netsam.html"><img src="../../../../../https/static.myopera.com/avatars/pool1/f3/573/bfa12fb644e9d1d9aba3772960d83e3e53e." alt="photo" class="avatar"/></a>
      <p class="commenter"><a href="../../../author/netsam.html">netsam</a></p>
      <p class="commentdate">Tuesday, November 5, 2013</p>
      <section class="commentcontent"><span class="bubble-arrow"></span>Hello I would like to change tools putting a image of a tool like pencil ect into the canvas. How can I do?</section>
    </li>
    <li id="comment-113399142">
      <a href="../../../author/centauro41.html"><img src="../../../../../https/static.myopera.com/avatars/pool1/d0/b65/ccf29242dba3d36978d671eb50d1f06665c." alt="photo" class="avatar"/></a>
      <p class="commenter"><a href="../../../author/centauro41.html">centauro41</a></p>
      <p class="commentdate">Friday, November 8, 2013</p>
      <section class="commentcontent"><span class="bubble-arrow"></span>@Chris Mills<br/>I would like to put a tool icon like a small &quot;arrow-icon&quot; for the arrow tool or a small &quot;rectangle-icon&quot; for the rectangle tool to send my request to the javascript instead of the &lt;select id=&quot;dtool&quot;&gt;&lt;/select&gt; tag.<br/><br/>Maybe like <img src="http://dev.opera.com/articles/view/html5-canvas-painting/arrow.jpg" id="rect" /> or something like that.<br/>How can i do this? <br/><br/>Thanks in advance!</section>
    </li>
    <li id="comment-113768942">
      <a href="../../../author/nephi12.html"><img src="../../../../../https/static.myopera.com/avatars/pool1/96/165/37fe899682278ed938d3a608866cd2427e9.gif" alt="photo" class="avatar"/></a>
      <p class="commenter"><a href="../../../author/nephi12.html">Ben Miller</a></p>
      <p class="commentdate">Wednesday, November 27, 2013</p>
      <section class="commentcontent"><span class="bubble-arrow"></span>something like this?:<br/><br/>&lt;.button onclick=&quot;picktool(this.title)&quot; title=&quot;rect&quot;&gt;&lt;.img src=&quot;rect.png&quot; width=&quot;20px&quot; height=&quot;20px&quot;&gt;&lt;/.button&gt;<br/>&lt;.script&gt;<br/>function picktool(toolname)<br/>{<br/>    //getthetool<br/>   //...<br/>}<br/>&lt;/script&gt;</section>
    </li>
  </ul>
No new comments accepted.
</section>

  </section>

  <aside>
    <section class="info">
      <p class="author"><strong>Author</strong> <a href="../../../author/robodesign.html" rel="author">Mihai Sucan</a></p>
      <p>
        <strong>Date</strong>
        Tuesday, March 17, 2009
      </p>

      <p class="tags"><strong>Tags</strong></p>
      <ul class="tags">
        <li><a href="../../tags/canvas.html" rel="tag">canvas</a></li>
        <li><a href="../../tags/events.html" rel="tag">events</a></li>
        <li><a href="../../tags/graphics.html" rel="tag">graphics</a></li>
        <li><a href="../../tags/html5.html" rel="tag">html5</a></li>
        <li><a href="../../tags/javascript.html" rel="tag">javascript</a></li>
      </ul>
    </section>
  </aside>




</section>
<script type="text/javascript" src="../../../../static.myopera.com/dev/js/highlight.pack.js"></script>
<script type="text/javascript">hljs.initHighlightingOnLoad();</script>

    <footer>
      <section role="contentinfo">
        <ul>
          <li><a href="../../../help.html">Help/<abbr>FAQ</abbr></a>
          <li><a href="http://my.opera.com/community/terms-of-service/?utm_source=devopera&amp;utm_medium=footer&amp;utm_campaign=devlinks">Terms of service</a>
          <li><a href="../../../privacy.html">Privacy</a>
        </ul>
      </section>
    </footer>
  </body>
</html>
